<?xml version="1.0" encoding="UTF-8"?>
<TestScript xmlns="http://hl7.org/fhir">
    <id value="medmij-bgz-xis-1-3-serve-bgz-xml"/>
    <url value="http://nictiz.nl/fhir/TestScript/medmij-bgz-xis-1-3-serve-bgz-xml"/>
    <version value="stu3-2.1.4"/>
    <name value="Nictiz MedMij BgZ - XIS Server - Scenario 1.3 - Serve BgZ - XML"/>
    <status value="active"/>
    <date value="2021-07-27"/>
    <publisher value="Nictiz"/>
    <contact>
        <name value="Nictiz"/>
        <telecom>
            <system value="email"/>
            <value value="kwalificatie@nictiz.nl"/>
            <use value="work"/>
        </telecom>
    </contact>
    <description value="MedMij BgZ for FHIR STU3 - Scenario 1.3: Serve BgZ - XML Format - All BgZ resources of person 2, testing for response on not implemented FHIR endpoints. It is expected that the Patient endpoint is implemented. Response is an HTTP satus code indicating an error and an OperationOutcome resource."/>
    <copyright value="Â© Nictiz 2018"/>
    <fixture id="patient-token-fixture">
        <resource>
            <reference value="../_reference/resources/medmij-bgz-patient-ts-02-token.xml"/>
        </resource>
    </fixture>
    <fixture id="patient1-fixture">
        <resource>
            <reference value="../_reference/resources/medmij-bgz-patient-ts-02.xml"/>
        </resource>
    </fixture>
    <profile id="Bundle-profile">
        <reference value="http://hl7.org/fhir/StructureDefinition/Bundle"/>
    </profile>
    <profile id="OperationOutcome-profile">
        <reference value="http://hl7.org/fhir/StructureDefinition/OperationOutcome"/>
    </profile>
    <variable>
        <name value="patient-token-id"/>
        <expression value="Patient.id"/>
        <sourceId value="patient-token-fixture"/>
    </variable>
    <variable>
        <name value="patient-profile"/>
        <expression value="Patient.meta.profile"/>
        <sourceId value="patient1-fixture"/>
    </variable>
    <variable>
        <name value="token-XXX-Mesker"/>
        <defaultValue value="Bearer 6056a9eb-da6a-45dc-b557-e854e138af8f"/>
        <!--<defaultValue value="${patient1-token-id}"/>-->
        <description value="OAuth Token for patient XXX_Mesker"/>
    </variable>
    <!-- No Setup -->
    <test id="01-ServeBgZ-Patient">
        <name value="01-ServeBgZ-Patient"/>
        <description value="Test XIS server search operation for known Patient resource of person 2 including the patient's general practitioner. The expected response code is 200(OK) and content is a searchset Bundle resource with 1 Patient resource entry, returned in XML format."/>
        <action>
            <operation>
                <type>
                    <system value="http://hl7.org/fhir/testscript-operation-codes"/>
                    <code value="search"/>
                </type>
                <resource value="Patient"/>
                <description value="XIS Server search operation for known Patient, including the referenced practitioner resource."/>
                <accept value="xml"/>
                <contentType value="none"/>
                <params value="?_include=Patient:general-practitioner"/>
                <requestHeader>
                    <!-- 0..* Each operation can have one or more header elements -->
                    <field value="Authorization"/>
                    <!-- 1..1 HTTP header field name: OAuth access token -->
                    <value value="${token-XXX-Mesker}"/>
                    <!-- 1..1 HTTP headerfield value: UUID4 -->
                </requestHeader>
                <requestHeader>
                    <field value="MedMij-Request-ID"/>
                    <value value="${UUID}"/>
                </requestHeader>
            </operation>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned HTTP status is 200(OK)."/>
                <direction value="response"/>
                <responseCode value="200"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned resource type is Bundle."/>
                <direction value="response"/>
                <resource value="Bundle"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle type is searchset."/>
                <direction value="response"/>
                <expression value="Bundle.type"/>
                <operator value="equals"/>
                <value value="searchset"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome as first resource or contains 1 Patient entry."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome) or entry.where(resource.is(Patient)).count() = 1).exists()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle total value matches or is less than the number of entries in the Bundle. The included resources should not be counted as entries in the Bundle.total."/>
                <direction value="response"/>
                <expression value="Bundle.total.toInteger() &lt;= Bundle.entry.where(search.empty() or search.mode = 'match').count()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the first returned resource contains a meta.profile tag."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome) or entry[0].resource.meta.profile).exists()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome as first resource or first returned resource contains a meta.profile tag matching the expected profile."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome) or entry.resource.where(meta.profile = '${patient-profile}')).exists()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that all returned resources contain a meta.profile tag."/>
                <direction value="response"/>
                <expression value="Bundle.entry.resource.where(is(OperationOutcome).not()).where(meta.profile.empty()).empty()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle conforms to the base FHIR specification and the resources to the stated profiles in the meta.profile tag."/>
                <direction value="response"/>
                <validateProfileId value="Bundle-profile"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that Bundle does not use Burgerservicenummer (BSN) anywhere."/>
                <direction value="response"/>
                <expression value="Bundle.descendants().select(identifier.where(system.toString() = 'http://fhir.nl/fhir/NamingSystem/bsn').where(value.empty())).count() = 0"/>
            </assert>
        </action>
    </test>
    <test id="02-ServeBgZ-Payer">
        <name value="02-ServeBgZ-Payer"/>
        <description value="Test XIS Server search operation for known Coverage resource of person 2 including the insurer in an Organization resource. The expected response code is 200 (OK) and content is an empty Bundle or a Bundle containing an OperationOutcome resource."/>
        <action>
            <operation>
                <type>
                    <system value="http://hl7.org/fhir/testscript-operation-codes"/>
                    <code value="search"/>
                </type>
                <resource value="Coverage"/>
                <description value="XIS Server search operation for known Coverage resources, including the .payor reference Organization resource."/>
                <accept value="xml"/>
                <contentType value="none"/>
                <params value="?_include=Coverage:payor:Patient&amp;_include=Coverage:payor:Organization"/>
                <requestHeader>
                    <!-- 0..* Each operation can have one or more header elements -->
                    <field value="Authorization"/>
                    <!-- 1..1 HTTP header field name: OAuth access token -->
                    <value value="${token-XXX-Mesker}"/>
                    <!-- 1..1 HTTP headerfield value: UUID4 -->
                </requestHeader>
                <requestHeader>
                    <field value="MedMij-Request-ID"/>
                    <value value="${UUID}"/>
                </requestHeader>
            </operation>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned HTTP status is 200 (OK)."/>
                <direction value="response"/>
                <responseCode value="200"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned resource type is OperationOutcome."/>
                <direction value="response"/>
                <resource value="Bundle"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned OperationOutcome conforms to the base FHIR specification."/>
                <direction value="response"/>
                <validateProfileId value="Bundle-profile"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle type is searchset."/>
                <direction value="response"/>
                <expression value="Bundle.type"/>
                <operator value="equals"/>
                <value value="searchset"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle total value matches or is greater than the number of entries in the Bundle."/>
                <direction value="response"/>
                <expression value="Bundle.total.toInteger() &gt;= Bundle.entry.where(search.empty() or search.mode = 'match').count()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome)).exists()"/>
            </assert>
        </action>
    </test>
    <test id="03-ServeBgZ-TreatmentDirective">
        <name value="03-ServeBgZ-TreatmentDirective"/>
        <description value="Test XIS Server search operation for known Consent resource with a category code for TreatmentDirective of person 2. The expected response code is 200 (OK) and content is an empty Bundle or a Bundle containing an OperationOutcome resource."/>
        <action>
            <operation>
                <type>
                    <system value="http://hl7.org/fhir/testscript-operation-codes"/>
                    <code value="search"/>
                </type>
                <resource value="Consent"/>
                <description value="XIS Server search operation for known Consent resources with a SNOMED category code for TreatmentDirective."/>
                <accept value="xml"/>
                <contentType value="none"/>
                <params value="?category=http://snomed.info/sct|11291000146105"/>
                <requestHeader>
                    <!-- 0..* Each operation can have one or more header elements -->
                    <field value="Authorization"/>
                    <!-- 1..1 HTTP header field name: OAuth access token -->
                    <value value="${token-XXX-Mesker}"/>
                    <!-- 1..1 HTTP headerfield value: UUID4 -->
                </requestHeader>
                <requestHeader>
                    <field value="MedMij-Request-ID"/>
                    <value value="${UUID}"/>
                </requestHeader>
            </operation>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned HTTP status is 200 (OK)."/>
                <direction value="response"/>
                <responseCode value="200"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned resource type is OperationOutcome."/>
                <direction value="response"/>
                <resource value="Bundle"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned OperationOutcome conforms to the base FHIR specification."/>
                <direction value="response"/>
                <validateProfileId value="Bundle-profile"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle type is searchset."/>
                <direction value="response"/>
                <expression value="Bundle.type"/>
                <operator value="equals"/>
                <value value="searchset"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle total value matches or is greater than the number of entries in the Bundle."/>
                <direction value="response"/>
                <expression value="Bundle.total.toInteger() &gt;= Bundle.entry.where(search.empty() or search.mode = 'match').count()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome)).exists()"/>
            </assert>
        </action>
    </test>
    <test id="04-ServeBgZ-AdvanceDirective">
        <name value="04-ServeBgZ-AdvanceDirective"/>
        <description value="Test XIS Server search operation for known Consent resource with a category code for AdvanceDirective of person 2. The expected response code is 200 (OK) and content is an empty Bundle or a Bundle containing an OperationOutcome resource."/>
        <action>
            <operation>
                <type>
                    <system value="http://hl7.org/fhir/testscript-operation-codes"/>
                    <code value="search"/>
                </type>
                <resource value="Consent"/>
                <description value="XIS Server search operation for known Consent resources with a SNOMED category code for AdvanceDirective."/>
                <accept value="xml"/>
                <contentType value="none"/>
                <params value="?category=http://snomed.info/sct|11341000146107"/>
                <requestHeader>
                    <!-- 0..* Each operation can have one or more header elements -->
                    <field value="Authorization"/>
                    <!-- 1..1 HTTP header field name: OAuth access token -->
                    <value value="${token-XXX-Mesker}"/>
                    <!-- 1..1 HTTP headerfield value: UUID4 -->
                </requestHeader>
                <requestHeader>
                    <field value="MedMij-Request-ID"/>
                    <value value="${UUID}"/>
                </requestHeader>
            </operation>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned HTTP status is 200 (OK)."/>
                <direction value="response"/>
                <responseCode value="200"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned resource type is OperationOutcome."/>
                <direction value="response"/>
                <resource value="Bundle"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned OperationOutcome conforms to the base FHIR specification."/>
                <direction value="response"/>
                <validateProfileId value="Bundle-profile"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle type is searchset."/>
                <direction value="response"/>
                <expression value="Bundle.type"/>
                <operator value="equals"/>
                <value value="searchset"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle total value matches or is greater than the number of entries in the Bundle."/>
                <direction value="response"/>
                <expression value="Bundle.total.toInteger() &gt;= Bundle.entry.where(search.empty() or search.mode = 'match').count()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome)).exists()"/>
            </assert>
        </action>
    </test>
    <test id="05-ServeBgZ-FunctionalOrMentalStatus">
        <name value="05-ServeBgZ-FunctionalOrMentalStatus"/>
        <description value="Test XIS Server search operation for last known Observation resource with a code for FunctionalOrMentalStatus of person 2. The expected response code is 200 (OK) and content is an empty Bundle or a Bundle containing an OperationOutcome resource."/>
        <action>
            <operation>
                <type>
                    <system value="http://hl7.org/fhir/testscript-operation-codes"/>
                    <code value="search"/>
                </type>
                <resource value="Observation"/>
                <description value="XIS Server search operation for last known Observation resource with a SNOMED code for FunctionalOrMentalStatus."/>
                <accept value="xml"/>
                <contentType value="none"/>
                <params value="/$lastn?category=http://snomed.info/sct|118228005,http://snomed.info/sct|384821006"/>
                <requestHeader>
                    <!-- 0..* Each operation can have one or more header elements -->
                    <field value="Authorization"/>
                    <!-- 1..1 HTTP header field name: OAuth access token -->
                    <value value="${token-XXX-Mesker}"/>
                    <!-- 1..1 HTTP headerfield value: UUID4 -->
                </requestHeader>
                <requestHeader>
                    <field value="MedMij-Request-ID"/>
                    <value value="${UUID}"/>
                </requestHeader>
            </operation>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned HTTP status is 200 (OK)."/>
                <direction value="response"/>
                <responseCode value="200"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned resource type is OperationOutcome."/>
                <direction value="response"/>
                <resource value="Bundle"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned OperationOutcome conforms to the base FHIR specification."/>
                <direction value="response"/>
                <validateProfileId value="Bundle-profile"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle type is searchset."/>
                <direction value="response"/>
                <expression value="Bundle.type"/>
                <operator value="equals"/>
                <value value="searchset"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle total value matches or is greater than the number of entries in the Bundle."/>
                <direction value="response"/>
                <expression value="Bundle.total.toInteger() &gt;= Bundle.entry.where(search.empty() or search.mode = 'match').count()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome)).exists()"/>
            </assert>
        </action>
    </test>
    <test id="06-ServeBgZ-Problem">
        <name value="06-ServeBgZ-Problem"/>
        <description value="Test XIS Server search operation for all known Condition resources of person 2. The expected response code is 200 (OK) and content is an empty Bundle or a Bundle containing an OperationOutcome resource."/>
        <action>
            <operation>
                <type>
                    <system value="http://hl7.org/fhir/testscript-operation-codes"/>
                    <code value="search"/>
                </type>
                <resource value="Condition"/>
                <description value="XIS Server search operation for all known Condition resources."/>
                <accept value="xml"/>
                <contentType value="none"/>
                <requestHeader>
                    <!-- 0..* Each operation can have one or more header elements -->
                    <field value="Authorization"/>
                    <!-- 1..1 HTTP header field name: OAuth access token -->
                    <value value="${token-XXX-Mesker}"/>
                    <!-- 1..1 HTTP headerfield value: UUID4 -->
                </requestHeader>
                <requestHeader>
                    <field value="MedMij-Request-ID"/>
                    <value value="${UUID}"/>
                </requestHeader>
            </operation>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned HTTP status is 200 (OK)."/>
                <direction value="response"/>
                <responseCode value="200"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned resource type is OperationOutcome."/>
                <direction value="response"/>
                <resource value="Bundle"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned OperationOutcome conforms to the base FHIR specification."/>
                <direction value="response"/>
                <validateProfileId value="Bundle-profile"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle type is searchset."/>
                <direction value="response"/>
                <expression value="Bundle.type"/>
                <operator value="equals"/>
                <value value="searchset"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle total value matches or is greater than the number of entries in the Bundle."/>
                <direction value="response"/>
                <expression value="Bundle.total.toInteger() &gt;= Bundle.entry.where(search.empty() or search.mode = 'match').count()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome)).exists()"/>
            </assert>
        </action>
    </test>
    <test id="07-ServeBgZ-LivingSituation">
        <name value="07-ServeBgZ-LivingSituation"/>
        <description value="Test XIS Server search operation for the last known Observation resrouce with a SNOMED code for LivingSituation of person 2. The expected response code is 200 (OK) and content is an empty Bundle or a Bundle containing an OperationOutcome resource."/>
        <action>
            <operation>
                <type>
                    <system value="http://hl7.org/fhir/testscript-operation-codes"/>
                    <code value="search"/>
                </type>
                <resource value="Observation"/>
                <description value="XIS Server search operation for all known Observation resources."/>
                <accept value="xml"/>
                <contentType value="none"/>
                <params value="/$lastn?code=http://snomed.info/sct|365508006"/>
                <requestHeader>
                    <!-- 0..* Each operation can have one or more header elements -->
                    <field value="Authorization"/>
                    <!-- 1..1 HTTP header field name: OAuth access token -->
                    <value value="${token-XXX-Mesker}"/>
                    <!-- 1..1 HTTP headerfield value: UUID4 -->
                </requestHeader>
                <requestHeader>
                    <field value="MedMij-Request-ID"/>
                    <value value="${UUID}"/>
                </requestHeader>
            </operation>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned HTTP status is 200 (OK)."/>
                <direction value="response"/>
                <responseCode value="200"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned resource type is OperationOutcome."/>
                <direction value="response"/>
                <resource value="Bundle"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned OperationOutcome conforms to the base FHIR specification."/>
                <direction value="response"/>
                <validateProfileId value="Bundle-profile"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle type is searchset."/>
                <direction value="response"/>
                <expression value="Bundle.type"/>
                <operator value="equals"/>
                <value value="searchset"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle total value matches or is greater than the number of entries in the Bundle."/>
                <direction value="response"/>
                <expression value="Bundle.total.toInteger() &gt;= Bundle.entry.where(search.empty() or search.mode = 'match').count()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome)).exists()"/>
            </assert>
        </action>
    </test>
    <test id="08-ServeBgZ-DrugUse">
        <name value="08-ServeBgZ-DrugUse"/>
        <description value="Test XIS Server search operation for all known Observation resrouces with a SNOMED code for DrugUse of person 2. The expected response code is 200 (OK) and content is an empty Bundle or a Bundle containing an OperationOutcome resource."/>
        <action>
            <operation>
                <type>
                    <system value="http://hl7.org/fhir/testscript-operation-codes"/>
                    <code value="search"/>
                </type>
                <resource value="Observation"/>
                <description value="XIS Server search operation for all known Observation resources with a SNOMED code for DrugUse."/>
                <accept value="xml"/>
                <contentType value="none"/>
                <params value="?code=http://snomed.info/sct|228366006"/>
                <requestHeader>
                    <!-- 0..* Each operation can have one or more header elements -->
                    <field value="Authorization"/>
                    <!-- 1..1 HTTP header field name: OAuth access token -->
                    <value value="${token-XXX-Mesker}"/>
                    <!-- 1..1 HTTP headerfield value: UUID4 -->
                </requestHeader>
                <requestHeader>
                    <field value="MedMij-Request-ID"/>
                    <value value="${UUID}"/>
                </requestHeader>
            </operation>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned HTTP status is 200 (OK)."/>
                <direction value="response"/>
                <responseCode value="200"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned resource type is OperationOutcome."/>
                <direction value="response"/>
                <resource value="Bundle"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned OperationOutcome conforms to the base FHIR specification."/>
                <direction value="response"/>
                <validateProfileId value="Bundle-profile"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle type is searchset."/>
                <direction value="response"/>
                <expression value="Bundle.type"/>
                <operator value="equals"/>
                <value value="searchset"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle total value matches or is greater than the number of entries in the Bundle."/>
                <direction value="response"/>
                <expression value="Bundle.total.toInteger() &gt;= Bundle.entry.where(search.empty() or search.mode = 'match').count()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome)).exists()"/>
            </assert>
        </action>
    </test>
    <test id="09-ServeBgZ-AlcoholUse">
        <name value="09-ServeBgZ-AlcoholUse"/>
        <description value="Test XIS Server search operation for all known Observation resrouces with a SNOMED code for AlcoholUse of person 2. The expected response code is 200 (OK) and content is an empty Bundle or a Bundle containing an OperationOutcome resource."/>
        <action>
            <operation>
                <type>
                    <system value="http://hl7.org/fhir/testscript-operation-codes"/>
                    <code value="search"/>
                </type>
                <resource value="Observation"/>
                <description value="XIS Server search operation for all known Observation resources with a SNOMED code for AlcoholUse."/>
                <accept value="xml"/>
                <contentType value="none"/>
                <params value="?code=http://snomed.info/sct|228273003"/>
                <requestHeader>
                    <!-- 0..* Each operation can have one or more header elements -->
                    <field value="Authorization"/>
                    <!-- 1..1 HTTP header field name: OAuth access token -->
                    <value value="${token-XXX-Mesker}"/>
                    <!-- 1..1 HTTP headerfield value: UUID4 -->
                </requestHeader>
                <requestHeader>
                    <field value="MedMij-Request-ID"/>
                    <value value="${UUID}"/>
                </requestHeader>
            </operation>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned HTTP status is 200 (OK)."/>
                <direction value="response"/>
                <responseCode value="200"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned resource type is OperationOutcome."/>
                <direction value="response"/>
                <resource value="Bundle"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned OperationOutcome conforms to the base FHIR specification."/>
                <direction value="response"/>
                <validateProfileId value="Bundle-profile"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle type is searchset."/>
                <direction value="response"/>
                <expression value="Bundle.type"/>
                <operator value="equals"/>
                <value value="searchset"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle total value matches or is greater than the number of entries in the Bundle."/>
                <direction value="response"/>
                <expression value="Bundle.total.toInteger() &gt;= Bundle.entry.where(search.empty() or search.mode = 'match').count()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome)).exists()"/>
            </assert>
        </action>
    </test>
    <test id="10-ServeBgZ-TobaccoUse">
        <name value="10-ServeBgZ-TobaccoUse"/>
        <description value="Test XIS Server search operation for all known Observation resrouces with a SNOMED code for TobaccoUse of person 2. The expected response code is 200 (OK) and content is an empty Bundle or a Bundle containing an OperationOutcome resource."/>
        <action>
            <operation>
                <type>
                    <system value="http://hl7.org/fhir/testscript-operation-codes"/>
                    <code value="search"/>
                </type>
                <resource value="Observation"/>
                <description value="XIS Server search operation for all known Observation resources with a SNOMED code for Tobaccouse."/>
                <accept value="xml"/>
                <contentType value="none"/>
                <params value="?code=http://snomed.info/sct|365980008"/>
                <requestHeader>
                    <!-- 0..* Each operation can have one or more header elements -->
                    <field value="Authorization"/>
                    <!-- 1..1 HTTP header field name: OAuth access token -->
                    <value value="${token-XXX-Mesker}"/>
                    <!-- 1..1 HTTP headerfield value: UUID4 -->
                </requestHeader>
                <requestHeader>
                    <field value="MedMij-Request-ID"/>
                    <value value="${UUID}"/>
                </requestHeader>
            </operation>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned HTTP status is 200 (OK)."/>
                <direction value="response"/>
                <responseCode value="200"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned resource type is OperationOutcome."/>
                <direction value="response"/>
                <resource value="Bundle"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned OperationOutcome conforms to the base FHIR specification."/>
                <direction value="response"/>
                <validateProfileId value="Bundle-profile"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle type is searchset."/>
                <direction value="response"/>
                <expression value="Bundle.type"/>
                <operator value="equals"/>
                <value value="searchset"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle total value matches or is greater than the number of entries in the Bundle."/>
                <direction value="response"/>
                <expression value="Bundle.total.toInteger() &gt;= Bundle.entry.where(search.empty() or search.mode = 'match').count()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome)).exists()"/>
            </assert>
        </action>
    </test>
    <test id="11-ServeBgZ-NutritionAdvice">
        <name value="11-ServeBgZ-NutritionAdvice"/>
        <description value="Test XIS Server search operation for all known NutritionOrder resources with an active status of person 2. The expected response code is 200 (OK) and content is an empty Bundle or a Bundle containing an OperationOutcome resource."/>
        <action>
            <operation>
                <type>
                    <system value="http://hl7.org/fhir/testscript-operation-codes"/>
                    <code value="search"/>
                </type>
                <resource value="NutritionOrder"/>
                <description value="XIS Server search operation for all known NutritionOrder resources with an active status."/>
                <accept value="xml"/>
                <contentType value="none"/>
                <params value="?status=active"/>
                <requestHeader>
                    <!-- 0..* Each operation can have one or more header elements -->
                    <field value="Authorization"/>
                    <!-- 1..1 HTTP header field name: OAuth access token -->
                    <value value="${token-XXX-Mesker}"/>
                    <!-- 1..1 HTTP headerfield value: UUID4 -->
                </requestHeader>
                <requestHeader>
                    <field value="MedMij-Request-ID"/>
                    <value value="${UUID}"/>
                </requestHeader>
            </operation>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned HTTP status is 200 (OK)."/>
                <direction value="response"/>
                <responseCode value="200"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned resource type is OperationOutcome."/>
                <direction value="response"/>
                <resource value="Bundle"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned OperationOutcome conforms to the base FHIR specification."/>
                <direction value="response"/>
                <validateProfileId value="Bundle-profile"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle type is searchset."/>
                <direction value="response"/>
                <expression value="Bundle.type"/>
                <operator value="equals"/>
                <value value="searchset"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle total value matches or is greater than the number of entries in the Bundle."/>
                <direction value="response"/>
                <expression value="Bundle.total.toInteger() &gt;= Bundle.entry.where(search.empty() or search.mode = 'match').count()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome)).exists()"/>
            </assert>
        </action>
    </test>
    <test id="12-ServeBgZ-Alert">
        <name value="12-ServeBgZ-Alert"/>
        <description value="Test XIS Server search operation for all Flag resources of person 2. The expected response code is 200 (OK) and content is an empty Bundle or a Bundle containing an OperationOutcome resource."/>
        <action>
            <operation>
                <type>
                    <system value="http://hl7.org/fhir/testscript-operation-codes"/>
                    <code value="search"/>
                </type>
                <resource value="Flag"/>
                <description value="XIS Server search operation for all Flag resources."/>
                <accept value="xml"/>
                <contentType value="none"/>
                <requestHeader>
                    <!-- 0..* Each operation can have one or more header elements -->
                    <field value="Authorization"/>
                    <!-- 1..1 HTTP header field name: OAuth access token -->
                    <value value="${token-XXX-Mesker}"/>
                    <!-- 1..1 HTTP headerfield value: UUID4 -->
                </requestHeader>
                <requestHeader>
                    <field value="MedMij-Request-ID"/>
                    <value value="${UUID}"/>
                </requestHeader>
            </operation>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned HTTP status is 200 (OK)."/>
                <direction value="response"/>
                <responseCode value="200"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned resource type is OperationOutcome."/>
                <direction value="response"/>
                <resource value="Bundle"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned OperationOutcome conforms to the base FHIR specification."/>
                <direction value="response"/>
                <validateProfileId value="Bundle-profile"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle type is searchset."/>
                <direction value="response"/>
                <expression value="Bundle.type"/>
                <operator value="equals"/>
                <value value="searchset"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle total value matches or is greater than the number of entries in the Bundle."/>
                <direction value="response"/>
                <expression value="Bundle.total.toInteger() &gt;= Bundle.entry.where(search.empty() or search.mode = 'match').count()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome)).exists()"/>
            </assert>
        </action>
    </test>
    <test id="13-ServeBgZ-AllergyIntolerance">
        <name value="13-ServeBgZ-AllergyIntolerance"/>
        <description value="Test XIS Server search operation for all AllergyIntolerance resources of person 2. The expected response code is 200 (OK) and content is an empty Bundle or a Bundle containing an OperationOutcome resource."/>
        <action>
            <operation>
                <type>
                    <system value="http://hl7.org/fhir/testscript-operation-codes"/>
                    <code value="search"/>
                </type>
                <resource value="AllergyIntolerance"/>
                <description value="XIS Server search operation for all AllergyIntolerance resources."/>
                <accept value="xml"/>
                <contentType value="none"/>
                <requestHeader>
                    <!-- 0..* Each operation can have one or more header elements -->
                    <field value="Authorization"/>
                    <!-- 1..1 HTTP header field name: OAuth access token -->
                    <value value="${token-XXX-Mesker}"/>
                    <!-- 1..1 HTTP headerfield value: UUID4 -->
                </requestHeader>
                <requestHeader>
                    <field value="MedMij-Request-ID"/>
                    <value value="${UUID}"/>
                </requestHeader>
            </operation>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned HTTP status is 200 (OK)."/>
                <direction value="response"/>
                <responseCode value="200"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned resource type is OperationOutcome."/>
                <direction value="response"/>
                <resource value="Bundle"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned OperationOutcome conforms to the base FHIR specification."/>
                <direction value="response"/>
                <validateProfileId value="Bundle-profile"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle type is searchset."/>
                <direction value="response"/>
                <expression value="Bundle.type"/>
                <operator value="equals"/>
                <value value="searchset"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle total value matches or is greater than the number of entries in the Bundle."/>
                <direction value="response"/>
                <expression value="Bundle.total.toInteger() &gt;= Bundle.entry.where(search.empty() or search.mode = 'match').count()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome)).exists()"/>
            </assert>
        </action>
    </test>
    <test id="14-ServeBgZ-MedicationUse">
        <name value="14-ServeBgZ-MedicationUse"/>
        <description value="Test XIS Server search operation for all MedicationStatement resources with a category code for MedicationUse of person 2, including the Medication resource. The expected response code is 200 (OK) and content is an empty Bundle or a Bundle containing an OperationOutcome resource."/>
        <action>
            <operation>
                <type>
                    <system value="http://hl7.org/fhir/testscript-operation-codes"/>
                    <code value="search"/>
                </type>
                <resource value="MedicationStatement"/>
                <description value="XIS Server search operation for all MedicationStatement resources with a category code for MedicationUse and include Medication resources."/>
                <accept value="xml"/>
                <contentType value="none"/>
                <params value="?category=urn:oid:2.16.840.1.113883.2.4.3.11.60.20.77.5.3|6&amp;_include=MedicationStatement:medication"/>
                <requestHeader>
                    <!-- 0..* Each operation can have one or more header elements -->
                    <field value="Authorization"/>
                    <!-- 1..1 HTTP header field name: OAuth access token -->
                    <value value="${token-XXX-Mesker}"/>
                    <!-- 1..1 HTTP headerfield value: UUID4 -->
                </requestHeader>
                <requestHeader>
                    <field value="MedMij-Request-ID"/>
                    <value value="${UUID}"/>
                </requestHeader>
            </operation>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned HTTP status is 200 (OK)."/>
                <direction value="response"/>
                <responseCode value="200"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned resource type is OperationOutcome."/>
                <direction value="response"/>
                <resource value="Bundle"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned OperationOutcome conforms to the base FHIR specification."/>
                <direction value="response"/>
                <validateProfileId value="Bundle-profile"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle type is searchset."/>
                <direction value="response"/>
                <expression value="Bundle.type"/>
                <operator value="equals"/>
                <value value="searchset"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle total value matches or is greater than the number of entries in the Bundle."/>
                <direction value="response"/>
                <expression value="Bundle.total.toInteger() &gt;= Bundle.entry.where(search.empty() or search.mode = 'match').count()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome)).exists()"/>
            </assert>
        </action>
    </test>
    <test id="15-ServeBgZ-MedicationAgreement">
        <name value="15-ServeBgZ-MedicationAgreement"/>
        <description value="Test XIS Server search operation for all MedicationRequest resources with a category code for MedicationAgreement of person 2, including the Medication resource. The expected response code is 200 (OK) and content is an empty Bundle or a Bundle containing an OperationOutcome resource."/>
        <action>
            <operation>
                <type>
                    <system value="http://hl7.org/fhir/testscript-operation-codes"/>
                    <code value="search"/>
                </type>
                <resource value="MedicationRequest"/>
                <description value="XIS Server search operation for all MedicationRequest resources with a category code for MedicationAgreement and include Medication resources."/>
                <accept value="xml"/>
                <contentType value="none"/>
                <params value="?category=http://snomed.info/sct|16076005&amp;_include=MedicationRequest:medication"/>
                <requestHeader>
                    <!-- 0..* Each operation can have one or more header elements -->
                    <field value="Authorization"/>
                    <!-- 1..1 HTTP header field name: OAuth access token -->
                    <value value="${token-XXX-Mesker}"/>
                    <!-- 1..1 HTTP headerfield value: UUID4 -->
                </requestHeader>
                <requestHeader>
                    <field value="MedMij-Request-ID"/>
                    <value value="${UUID}"/>
                </requestHeader>
            </operation>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned HTTP status is 200 (OK)."/>
                <direction value="response"/>
                <responseCode value="200"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned resource type is OperationOutcome."/>
                <direction value="response"/>
                <resource value="Bundle"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned OperationOutcome conforms to the base FHIR specification."/>
                <direction value="response"/>
                <validateProfileId value="Bundle-profile"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle type is searchset."/>
                <direction value="response"/>
                <expression value="Bundle.type"/>
                <operator value="equals"/>
                <value value="searchset"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle total value matches or is greater than the number of entries in the Bundle."/>
                <direction value="response"/>
                <expression value="Bundle.total.toInteger() &gt;= Bundle.entry.where(search.empty() or search.mode = 'match').count()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome)).exists()"/>
            </assert>
        </action>
    </test>
    <test id="16-ServeBgZ-AdministrationAgreement">
        <name value="16-ServeBgZ-AdministrationAgreement"/>
        <description value="Test XIS Server search operation for all MedicationDispense resources with a category code for AdministrationAgreement of person 2, including the Medication resource. The expected response code is 200 (OK) and content is an empty Bundle or a Bundle containing an OperationOutcome resource."/>
        <action>
            <operation>
                <type>
                    <system value="http://hl7.org/fhir/testscript-operation-codes"/>
                    <code value="search"/>
                </type>
                <resource value="MedicationDispense"/>
                <description value="XIS Server search operation for all MedicationRequest resources with a category code for MedicationAgreement and include Medication resources."/>
                <accept value="xml"/>
                <contentType value="none"/>
                <params value="?category=http://snomed.info/sct|422037009&amp;_include=MedicationDispense:medication"/>
                <requestHeader>
                    <!-- 0..* Each operation can have one or more header elements -->
                    <field value="Authorization"/>
                    <!-- 1..1 HTTP header field name: OAuth access token -->
                    <value value="${token-XXX-Mesker}"/>
                    <!-- 1..1 HTTP headerfield value: UUID4 -->
                </requestHeader>
                <requestHeader>
                    <field value="MedMij-Request-ID"/>
                    <value value="${UUID}"/>
                </requestHeader>
            </operation>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned HTTP status is 200 (OK)."/>
                <direction value="response"/>
                <responseCode value="200"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned resource type is OperationOutcome."/>
                <direction value="response"/>
                <resource value="Bundle"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned OperationOutcome conforms to the base FHIR specification."/>
                <direction value="response"/>
                <validateProfileId value="Bundle-profile"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle type is searchset."/>
                <direction value="response"/>
                <expression value="Bundle.type"/>
                <operator value="equals"/>
                <value value="searchset"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle total value matches or is greater than the number of entries in the Bundle."/>
                <direction value="response"/>
                <expression value="Bundle.total.toInteger() &gt;= Bundle.entry.where(search.empty() or search.mode = 'match').count()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome)).exists()"/>
            </assert>
        </action>
    </test>
    <test id="17-ServeBgZ-MedicalDevice">
        <name value="17-ServeBgZ-MedicalDevice"/>
        <description value="Test XIS Server search operation for all DeviceUseStatement resources of person 2, including Device resources. The expected response code is 200 (OK) and content is an empty Bundle or a Bundle containing an OperationOutcome resource."/>
        <action>
            <operation>
                <type>
                    <system value="http://hl7.org/fhir/testscript-operation-codes"/>
                    <code value="search"/>
                </type>
                <resource value="DeviceUseStatement"/>
                <description value="XIS Server search operation for all DeviceUseStatement and include Device resources."/>
                <accept value="xml"/>
                <contentType value="none"/>
                <params value="?_include=DeviceUseStatement:device"/>
                <requestHeader>
                    <!-- 0..* Each operation can have one or more header elements -->
                    <field value="Authorization"/>
                    <!-- 1..1 HTTP header field name: OAuth access token -->
                    <value value="${token-XXX-Mesker}"/>
                    <!-- 1..1 HTTP headerfield value: UUID4 -->
                </requestHeader>
                <requestHeader>
                    <field value="MedMij-Request-ID"/>
                    <value value="${UUID}"/>
                </requestHeader>
            </operation>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned HTTP status is 200 (OK)."/>
                <direction value="response"/>
                <responseCode value="200"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned resource type is OperationOutcome."/>
                <direction value="response"/>
                <resource value="Bundle"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned OperationOutcome conforms to the base FHIR specification."/>
                <direction value="response"/>
                <validateProfileId value="Bundle-profile"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle type is searchset."/>
                <direction value="response"/>
                <expression value="Bundle.type"/>
                <operator value="equals"/>
                <value value="searchset"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle total value matches or is greater than the number of entries in the Bundle."/>
                <direction value="response"/>
                <expression value="Bundle.total.toInteger() &gt;= Bundle.entry.where(search.empty() or search.mode = 'match').count()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome)).exists()"/>
            </assert>
        </action>
    </test>
    <test id="18-ServeBgZ-Vaccination">
        <name value="18-ServeBgZ-Vaccination"/>
        <description value="Test XIS Server search operation for all Immunization resources with a completed status of person 2. The expected response code is 200 (OK) and content is an empty Bundle or a Bundle containing an OperationOutcome resource."/>
        <action>
            <operation>
                <type>
                    <system value="http://hl7.org/fhir/testscript-operation-codes"/>
                    <code value="search"/>
                </type>
                <resource value="Immunization"/>
                <description value="XIS Server search operation for all Immunization resources that are completed."/>
                <accept value="xml"/>
                <contentType value="none"/>
                <params value="?status=completed"/>
                <requestHeader>
                    <!-- 0..* Each operation can have one or more header elements -->
                    <field value="Authorization"/>
                    <!-- 1..1 HTTP header field name: OAuth access token -->
                    <value value="${token-XXX-Mesker}"/>
                    <!-- 1..1 HTTP headerfield value: UUID4 -->
                </requestHeader>
                <requestHeader>
                    <field value="MedMij-Request-ID"/>
                    <value value="${UUID}"/>
                </requestHeader>
            </operation>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned HTTP status is 200 (OK)."/>
                <direction value="response"/>
                <responseCode value="200"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned resource type is OperationOutcome."/>
                <direction value="response"/>
                <resource value="Bundle"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned OperationOutcome conforms to the base FHIR specification."/>
                <direction value="response"/>
                <validateProfileId value="Bundle-profile"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle type is searchset."/>
                <direction value="response"/>
                <expression value="Bundle.type"/>
                <operator value="equals"/>
                <value value="searchset"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle total value matches or is greater than the number of entries in the Bundle."/>
                <direction value="response"/>
                <expression value="Bundle.total.toInteger() &gt;= Bundle.entry.where(search.empty() or search.mode = 'match').count()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome)).exists()"/>
            </assert>
        </action>
    </test>
    <test id="19-ServeBgZ-BloodPressure">
        <name value="19-ServeBgZ-BloodPressure"/>
        <description value="Test XIS Server search operation for the last known Obervation resources with a code for BloodPressure of person 2. The expected response code is 200 (OK) and content is an empty Bundle or a Bundle containing an OperationOutcome resource."/>
        <action>
            <operation>
                <type>
                    <system value="http://hl7.org/fhir/testscript-operation-codes"/>
                    <code value="search"/>
                </type>
                <resource value="Observation"/>
                <description value="XIS Server search operation for the last kown Observation resource with a code for BloodPressure."/>
                <accept value="xml"/>
                <contentType value="none"/>
                <params value="/$lastn?code=http://loinc.org|85354-9"/>
                <requestHeader>
                    <!-- 0..* Each operation can have one or more header elements -->
                    <field value="Authorization"/>
                    <!-- 1..1 HTTP header field name: OAuth access token -->
                    <value value="${token-XXX-Mesker}"/>
                    <!-- 1..1 HTTP headerfield value: UUID4 -->
                </requestHeader>
                <requestHeader>
                    <field value="MedMij-Request-ID"/>
                    <value value="${UUID}"/>
                </requestHeader>
            </operation>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned HTTP status is 200 (OK)."/>
                <direction value="response"/>
                <responseCode value="200"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned resource type is OperationOutcome."/>
                <direction value="response"/>
                <resource value="Bundle"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned OperationOutcome conforms to the base FHIR specification."/>
                <direction value="response"/>
                <validateProfileId value="Bundle-profile"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle type is searchset."/>
                <direction value="response"/>
                <expression value="Bundle.type"/>
                <operator value="equals"/>
                <value value="searchset"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle total value matches or is greater than the number of entries in the Bundle."/>
                <direction value="response"/>
                <expression value="Bundle.total.toInteger() &gt;= Bundle.entry.where(search.empty() or search.mode = 'match').count()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome)).exists()"/>
            </assert>
        </action>
    </test>
    <test id="20-ServeBgZ-BodyWeight">
        <name value="20-ServeBgZ-BodyWeight"/>
        <description value="Test XIS Server search operation for the last known Obervation resources with a code for BodyWeight of person 2. The expected response code is 200 (OK) and content is an empty Bundle or a Bundle containing an OperationOutcome resource."/>
        <action>
            <operation>
                <type>
                    <system value="http://hl7.org/fhir/testscript-operation-codes"/>
                    <code value="search"/>
                </type>
                <resource value="Observation"/>
                <description value="XIS Server search operation for the last kown Observation resource with a code for BodyWeight."/>
                <accept value="xml"/>
                <contentType value="none"/>
                <params value="/$lastn?code=http://loinc.org|29463-7"/>
                <requestHeader>
                    <!-- 0..* Each operation can have one or more header elements -->
                    <field value="Authorization"/>
                    <!-- 1..1 HTTP header field name: OAuth access token -->
                    <value value="${token-XXX-Mesker}"/>
                    <!-- 1..1 HTTP headerfield value: UUID4 -->
                </requestHeader>
                <requestHeader>
                    <field value="MedMij-Request-ID"/>
                    <value value="${UUID}"/>
                </requestHeader>
            </operation>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned HTTP status is 200 (OK)."/>
                <direction value="response"/>
                <responseCode value="200"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned resource type is OperationOutcome."/>
                <direction value="response"/>
                <resource value="Bundle"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned OperationOutcome conforms to the base FHIR specification."/>
                <direction value="response"/>
                <validateProfileId value="Bundle-profile"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle type is searchset."/>
                <direction value="response"/>
                <expression value="Bundle.type"/>
                <operator value="equals"/>
                <value value="searchset"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle total value matches or is greater than the number of entries in the Bundle."/>
                <direction value="response"/>
                <expression value="Bundle.total.toInteger() &gt;= Bundle.entry.where(search.empty() or search.mode = 'match').count()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome)).exists()"/>
            </assert>
        </action>
    </test>
    <test id="21-ServeBgZ-BodyHeight">
        <name value="21-ServeBgZ-BodyHeight"/>
        <description value="Test XIS Server search operation for the last known Obervation resources with a code for BodyHeight of person 2. The expected response code is 200 (OK) and content is an empty Bundle or a Bundle containing an OperationOutcome resource."/>
        <action>
            <operation>
                <type>
                    <system value="http://hl7.org/fhir/testscript-operation-codes"/>
                    <code value="search"/>
                </type>
                <resource value="Observation"/>
                <description value="XIS Server search operation for the last kown Observation resource with a code for BodyHeight."/>
                <accept value="xml"/>
                <contentType value="none"/>
                <params value="/$lastn?code=http://loinc.org|8302-2,http://loinc.org|8306-3,http://loinc.org|8308-9"/>
                <requestHeader>
                    <!-- 0..* Each operation can have one or more header elements -->
                    <field value="Authorization"/>
                    <!-- 1..1 HTTP header field name: OAuth access token -->
                    <value value="${token-XXX-Mesker}"/>
                    <!-- 1..1 HTTP headerfield value: UUID4 -->
                </requestHeader>
                <requestHeader>
                    <field value="MedMij-Request-ID"/>
                    <value value="${UUID}"/>
                </requestHeader>
            </operation>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned HTTP status is 200 (OK)."/>
                <direction value="response"/>
                <responseCode value="200"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned resource type is OperationOutcome."/>
                <direction value="response"/>
                <resource value="Bundle"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned OperationOutcome conforms to the base FHIR specification."/>
                <direction value="response"/>
                <validateProfileId value="Bundle-profile"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle type is searchset."/>
                <direction value="response"/>
                <expression value="Bundle.type"/>
                <operator value="equals"/>
                <value value="searchset"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle total value matches or is greater than the number of entries in the Bundle."/>
                <direction value="response"/>
                <expression value="Bundle.total.toInteger() &gt;= Bundle.entry.where(search.empty() or search.mode = 'match').count()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome)).exists()"/>
            </assert>
        </action>
    </test>
    <test id="22-ServeBgZ-LaboratoryTestResult">
        <name value="22-ServeBgZ-LaboratoryTestResult"/>
        <description value="Test XIS Server search operation for the last known Obervation resources with a category for LaboratoryTestResult, specific for Chemistry observations of person 2, including the referenced Specimem resource. The expected response code is 200 (OK) and content is an empty Bundle or a Bundle containing an OperationOutcome resource."/>
        <action>
            <operation>
                <type>
                    <system value="http://hl7.org/fhir/testscript-operation-codes"/>
                    <code value="search"/>
                </type>
                <resource value="Observation"/>
                <description value="XIS Server search operation for the last kown Observation resource with a category for LaboratoryTestResult, specific for Chemistry observations, including the referenced Specimem resource."/>
                <accept value="xml"/>
                <contentType value="none"/>
                <params value="/$lastn?category=http://snomed.info/sct|275711006&amp;_include=Observation:related-target&amp;_include=Observation:specimen"/>
                <requestHeader>
                    <!-- 0..* Each operation can have one or more header elements -->
                    <field value="Authorization"/>
                    <!-- 1..1 HTTP header field name: OAuth access token -->
                    <value value="${token-XXX-Mesker}"/>
                    <!-- 1..1 HTTP headerfield value: UUID4 -->
                </requestHeader>
                <requestHeader>
                    <field value="MedMij-Request-ID"/>
                    <value value="${UUID}"/>
                </requestHeader>
            </operation>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned HTTP status is 200 (OK)."/>
                <direction value="response"/>
                <responseCode value="200"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned resource type is OperationOutcome."/>
                <direction value="response"/>
                <resource value="Bundle"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned OperationOutcome conforms to the base FHIR specification."/>
                <direction value="response"/>
                <validateProfileId value="Bundle-profile"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle type is searchset."/>
                <direction value="response"/>
                <expression value="Bundle.type"/>
                <operator value="equals"/>
                <value value="searchset"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle total value matches or is greater than the number of entries in the Bundle."/>
                <direction value="response"/>
                <expression value="Bundle.total.toInteger() &gt;= Bundle.entry.where(search.empty() or search.mode = 'match').count()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome)).exists()"/>
            </assert>
        </action>
    </test>
    <test id="23-ServeBgZ-Procedure">
        <name value="23-ServeBgZ-Procedure"/>
        <description value="Test XIS Server search operation for all known Procedure resources with a category for surgical procedures of person 2. The expected response code is 200 (OK) and content is an empty Bundle or a Bundle containing an OperationOutcome resource."/>
        <action>
            <operation>
                <type>
                    <system value="http://hl7.org/fhir/testscript-operation-codes"/>
                    <code value="search"/>
                </type>
                <resource value="Procedure"/>
                <description value="XIS Server search operation for Procedure resources with a category for surgical procedures."/>
                <accept value="xml"/>
                <contentType value="none"/>
                <params value="?category=http://snomed.info/sct|387713003"/>
                <requestHeader>
                    <!-- 0..* Each operation can have one or more header elements -->
                    <field value="Authorization"/>
                    <!-- 1..1 HTTP header field name: OAuth access token -->
                    <value value="${token-XXX-Mesker}"/>
                    <!-- 1..1 HTTP headerfield value: UUID4 -->
                </requestHeader>
                <requestHeader>
                    <field value="MedMij-Request-ID"/>
                    <value value="${UUID}"/>
                </requestHeader>
            </operation>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned HTTP status is 200 (OK)."/>
                <direction value="response"/>
                <responseCode value="200"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned resource type is OperationOutcome."/>
                <direction value="response"/>
                <resource value="Bundle"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned OperationOutcome conforms to the base FHIR specification."/>
                <direction value="response"/>
                <validateProfileId value="Bundle-profile"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle type is searchset."/>
                <direction value="response"/>
                <expression value="Bundle.type"/>
                <operator value="equals"/>
                <value value="searchset"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle total value matches or is greater than the number of entries in the Bundle."/>
                <direction value="response"/>
                <expression value="Bundle.total.toInteger() &gt;= Bundle.entry.where(search.empty() or search.mode = 'match').count()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome)).exists()"/>
            </assert>
        </action>
    </test>
    <test id="24-ServeBgZ-Contact">
        <name value="24-ServeBgZ-Contact"/>
        <description value="Test XIS Server search operation for all known Encounter resources with a class for hospital admissions of person 2. The expected response code is 200 (OK) and content is an empty Bundle or a Bundle containing an OperationOutcome resource."/>
        <action>
            <operation>
                <type>
                    <system value="http://hl7.org/fhir/testscript-operation-codes"/>
                    <code value="search"/>
                </type>
                <resource value="Encounter"/>
                <description value="XIS Server search operation for Encounter resources with a class for hospital admissions."/>
                <accept value="xml"/>
                <contentType value="none"/>
                <params value="?class=http://hl7.org/fhir/v3/ActCode|IMP,http://hl7.org/fhir/v3/ActCode|ACUTE,http://hl7.org/fhir/v3/ActCode|NONAC"/>
                <requestHeader>
                    <!-- 0..* Each operation can have one or more header elements -->
                    <field value="Authorization"/>
                    <!-- 1..1 HTTP header field name: OAuth access token -->
                    <value value="${token-XXX-Mesker}"/>
                    <!-- 1..1 HTTP headerfield value: UUID4 -->
                </requestHeader>
                <requestHeader>
                    <field value="MedMij-Request-ID"/>
                    <value value="${UUID}"/>
                </requestHeader>
            </operation>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned HTTP status is 200 (OK)."/>
                <direction value="response"/>
                <responseCode value="200"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned resource type is OperationOutcome."/>
                <direction value="response"/>
                <resource value="Bundle"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned OperationOutcome conforms to the base FHIR specification."/>
                <direction value="response"/>
                <validateProfileId value="Bundle-profile"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle type is searchset."/>
                <direction value="response"/>
                <expression value="Bundle.type"/>
                <operator value="equals"/>
                <value value="searchset"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle total value matches or is greater than the number of entries in the Bundle."/>
                <direction value="response"/>
                <expression value="Bundle.total.toInteger() &gt;= Bundle.entry.where(search.empty() or search.mode = 'match').count()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome)).exists()"/>
            </assert>
        </action>
    </test>
    <test id="25-ServeBgZ-PlannedCareActivity-ProcedureRequest">
        <name value="25-ServeBgZ-PlannedCareActivity-ProcedureRequest"/>
        <description value="Test XIS Server search operation for all known ProcedureRequest resources with a active status of person 2. The expected response code is 200 (OK) and content is an empty Bundle or a Bundle containing an OperationOutcome resource."/>
        <action>
            <operation>
                <type>
                    <system value="http://hl7.org/fhir/testscript-operation-codes"/>
                    <code value="search"/>
                </type>
                <resource value="ProcedureRequest"/>
                <description value="XIS Server search operation for ProcedureRequest resources with a active status."/>
                <accept value="xml"/>
                <contentType value="none"/>
                <params value="?status=active"/>
                <requestHeader>
                    <!-- 0..* Each operation can have one or more header elements -->
                    <field value="Authorization"/>
                    <!-- 1..1 HTTP header field name: OAuth access token -->
                    <value value="${token-XXX-Mesker}"/>
                    <!-- 1..1 HTTP headerfield value: UUID4 -->
                </requestHeader>
                <requestHeader>
                    <field value="MedMij-Request-ID"/>
                    <value value="${UUID}"/>
                </requestHeader>
            </operation>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned HTTP status is 200 (OK)."/>
                <direction value="response"/>
                <responseCode value="200"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned resource type is OperationOutcome."/>
                <direction value="response"/>
                <resource value="Bundle"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned OperationOutcome conforms to the base FHIR specification."/>
                <direction value="response"/>
                <validateProfileId value="Bundle-profile"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle type is searchset."/>
                <direction value="response"/>
                <expression value="Bundle.type"/>
                <operator value="equals"/>
                <value value="searchset"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle total value matches or is greater than the number of entries in the Bundle."/>
                <direction value="response"/>
                <expression value="Bundle.total.toInteger() &gt;= Bundle.entry.where(search.empty() or search.mode = 'match').count()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome)).exists()"/>
            </assert>
        </action>
    </test>
    <test id="26-ServeBgZ-PlannedCareActivity-ImmunizationRecommendation">
        <name value="26-ServeBgZ-PlannedCareActivity-ImmunizationRecommendation"/>
        <description value="Test XIS Server search operation for all known ImmunizationRecommendation resources of person 2. The expected response code is 200 (OK) and content is an empty Bundle or a Bundle containing an OperationOutcome resource."/>
        <action>
            <operation>
                <type>
                    <system value="http://hl7.org/fhir/testscript-operation-codes"/>
                    <code value="search"/>
                </type>
                <resource value="ImmunizationRecommendation"/>
                <description value="XIS Server search operation for ImmunizationRecommendation resources."/>
                <accept value="xml"/>
                <contentType value="none"/>
                <requestHeader>
                    <!-- 0..* Each operation can have one or more header elements -->
                    <field value="Authorization"/>
                    <!-- 1..1 HTTP header field name: OAuth access token -->
                    <value value="${token-XXX-Mesker}"/>
                    <!-- 1..1 HTTP headerfield value: UUID4 -->
                </requestHeader>
                <requestHeader>
                    <field value="MedMij-Request-ID"/>
                    <value value="${UUID}"/>
                </requestHeader>
            </operation>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned HTTP status is 200 (OK)."/>
                <direction value="response"/>
                <responseCode value="200"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned resource type is OperationOutcome."/>
                <direction value="response"/>
                <resource value="Bundle"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned OperationOutcome conforms to the base FHIR specification."/>
                <direction value="response"/>
                <validateProfileId value="Bundle-profile"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle type is searchset."/>
                <direction value="response"/>
                <expression value="Bundle.type"/>
                <operator value="equals"/>
                <value value="searchset"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle total value matches or is greater than the number of entries in the Bundle."/>
                <direction value="response"/>
                <expression value="Bundle.total.toInteger() &gt;= Bundle.entry.where(search.empty() or search.mode = 'match').count()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome)).exists()"/>
            </assert>
        </action>
    </test>
    <test id="27-ServeBgZ-PlannedCareActivity-Appointment">
        <name value="27-ServeBgZ-PlannedCareActivity-Appointment"/>
        <description value="Test XIS Server search operation for all known future Appointment resources, with a booked, pending or proposed status of person 2. The expected response code is 200 (OK) and content is an empty Bundle or a Bundle containing an OperationOutcome resource."/>
        <action>
            <operation>
                <type>
                    <system value="http://hl7.org/fhir/testscript-operation-codes"/>
                    <code value="search"/>
                </type>
                <resource value="Appointment"/>
                <description value="XIS Server search operation for Appointment resources with a booked, pending or proposed status.."/>
                <accept value="xml"/>
                <contentType value="none"/>
                <params value="?status=booked,pending,proposed"/>
                <requestHeader>
                    <!-- 0..* Each operation can have one or more header elements -->
                    <field value="Authorization"/>
                    <!-- 1..1 HTTP header field name: OAuth access token -->
                    <value value="${token-XXX-Mesker}"/>
                    <!-- 1..1 HTTP headerfield value: UUID4 -->
                </requestHeader>
                <requestHeader>
                    <field value="MedMij-Request-ID"/>
                    <value value="${UUID}"/>
                </requestHeader>
            </operation>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned HTTP status is 200 (OK)."/>
                <direction value="response"/>
                <responseCode value="200"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned resource type is OperationOutcome."/>
                <direction value="response"/>
                <resource value="Bundle"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned OperationOutcome conforms to the base FHIR specification."/>
                <direction value="response"/>
                <validateProfileId value="Bundle-profile"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle type is searchset."/>
                <direction value="response"/>
                <expression value="Bundle.type"/>
                <operator value="equals"/>
                <value value="searchset"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle total value matches or is greater than the number of entries in the Bundle."/>
                <direction value="response"/>
                <expression value="Bundle.total.toInteger() &gt;= Bundle.entry.where(search.empty() or search.mode = 'match').count()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome)).exists()"/>
            </assert>
        </action>
    </test>
    <test id="28-ServeBgZ-PlannedCareActivity-DeviceRequest">
        <name value="28-ServeBgZ-PlannedCareActivity-DeviceRequest"/>
        <description value="Test XIS Server retrieve search operation for all known DeviceRequest resources, with a active status of person 1, including the Device resource. The expected response code is 200 (OK) and content is an empty Bundle or a Bundle containing an OperationOutcome resource."/>
        <action>
            <operation>
                <type>
                    <system value="http://hl7.org/fhir/testscript-operation-codes"/>
                    <code value="search"/>
                </type>
                <resource value="DeviceRequest"/>
                <description value="XIS Server search operation for DeviceRequest resources with an active status, including the Device resource."/>
                <accept value="xml"/>
                <contentType value="none"/>
                <params value="?status=active&amp;_include=DeviceRequest:device"/>
                <requestHeader>
                    <!-- 0..* Each operation can have one or more header elements -->
                    <field value="Authorization"/>
                    <!-- 1..1 HTTP header field name: OAuth access token -->
                    <value value="${token-XXX-Mesker}"/>
                    <!-- 1..1 HTTP headerfield value: UUID4 -->
                </requestHeader>
                <requestHeader>
                    <field value="MedMij-Request-ID"/>
                    <value value="${UUID}"/>
                </requestHeader>
            </operation>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned HTTP status is 200 (OK)."/>
                <direction value="response"/>
                <responseCode value="200"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned resource type is OperationOutcome."/>
                <direction value="response"/>
                <resource value="Bundle"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned OperationOutcome conforms to the base FHIR specification."/>
                <direction value="response"/>
                <validateProfileId value="Bundle-profile"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle type is searchset."/>
                <direction value="response"/>
                <expression value="Bundle.type"/>
                <operator value="equals"/>
                <value value="searchset"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned Bundle total value matches or is greater than the number of entries in the Bundle."/>
                <direction value="response"/>
                <expression value="Bundle.total.toInteger() &gt;= Bundle.entry.where(search.empty() or search.mode = 'match').count()"/>
            </assert>
        </action>
        <action>
            <assert>
                <description value="Confirm that the returned searchset Bundle is empty, or contains an OperationOutcome."/>
                <direction value="response"/>
                <expression value="Bundle.where(entry.empty() or entry[0].resource.is(OperationOutcome)).exists()"/>
            </assert>
        </action>
    </test>
</TestScript>
